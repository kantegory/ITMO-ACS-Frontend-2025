<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Поиск недвижимости — Площадь.ру</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<div data-include="../component/navbar.html"></div>

<main class="py-4">
  <div class="container">
    <h1 class="h3 mb-4">Поиск недвижимости</h1>
    <form id="filterForm" class="row g-3 mb-4">
      <div class="col-md-3">
        <label class="form-label" for="location">Город/район</label>
        <input type="text" class="form-control" id="location" placeholder="Москва">
      </div>
      <div class="col-md-3">
        <label class="form-label" for="type">Тип объекта</label>
        <select id="type" class="form-select">
          <option value="">Любой</option>
          <option value="flat">Квартира</option>
          <option value="room">Комната</option>
          <option value="country-house">Дом</option>
        </select>
      </div>
      <div class="col-md-2">
        <label class="form-label" for="priceFrom">Цена от, ₽</label>
        <input type="number" class="form-control" id="priceFrom" min="0">
      </div>
      <div class="col-md-2">
        <label class="form-label" for="priceTo">Цена до, ₽</label>
        <input type="number" class="form-control" id="priceTo" min="0">
      </div>
      <div class="col-md-2 d-flex align-items-end">
        <button type="submit" class="btn btn-primary w-100">Применить</button>
      </div>
    </form>
    <div class="row g-4" id="results">
    </div>
  </div>
</main>
<div data-include="../component/contact-modal.html"></div>
<div data-include="../component/footer.html"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="../js/include.js"></script>

<script>
  const form = document.getElementById('filterForm');
  form.addEventListener('submit', function (e) {
    e.preventDefault();
    const cards = document.querySelectorAll('.property-card');
    const type = document.getElementById('type').value;
    const priceFrom = parseInt(document.getElementById('priceFrom').value || '0', 10);
    const priceTo = parseInt(document.getElementById('priceTo').value || '100000000', 10);
    const location = document.getElementById('location').value.trim().toLowerCase();
    cards.forEach(card => {
      const cardType = card.dataset.type;
      const cardPrice = parseInt(card.dataset.price, 10);
      const cardLocation = card.dataset.location.toLowerCase();
      const matchType = !type || cardType === type;
      const matchPrice = cardPrice >= priceFrom && cardPrice <= priceTo;
      const matchLocation = !location || cardLocation.includes(location);
      if (matchType && matchPrice && matchLocation) {
        card.classList.remove('d-none');
      } else {
        card.classList.add('d-none');
      }
    });
  });
</script>

<script type="module">
  import {renderCards} from "../js/cards.js";

  const cards = [
    {
      type: "studio",
      price: 45000,
      priceText: "45 000 ₽/мес.",
      location: "Москва",
      address: "Москва, м. Бауманская",
      title: "Студия, 28 м²",
      description: "Уютная студия в новом доме.",
      image: "https://picsum.photos/400/250"
    },
    {
      type: "room",
      price: 20000,
      priceText: "20 000 ₽/мес.",
      location: "Санкт-Петербург",
      address: "СПб, Васильевский остров",
      title: "Комната 14 м²",
      description: "Комната в трёхкомнатной квартире.",
      image: "https://picsum.photos/400/250"
    }
  ];
  renderCards(cards);
</script>

<script>
  document.addEventListener("click", function (e) {
    if (e.target && e.target.id === "contactSendButton") {
      const messageInput = document.getElementById("contactMessage");
      const text = messageInput.value.trim();
      console.log("Сообщение владельцу:", text);
      const modalEl = document.getElementById("contactModal");
      const modal = bootstrap.Modal.getInstance(modalEl) || new bootstrap.Modal(modalEl);
      modal.hide();
      messageInput.value = "";
    }
  });
</script>
</body>
</html>
